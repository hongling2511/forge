#set( $dollar = '$' )
spring:
  application:
    name: ${artifactId}

  # Database Configuration (override via environment variables)
  datasource:
    url: ${dollar}{DB_URL:jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE}
    username: ${dollar}{DB_USER:sa}
    password: ${dollar}{DB_PASSWORD:}
    driver-class-name: ${dollar}{DB_DRIVER:org.h2.Driver}
    hikari:
      maximum-pool-size: ${dollar}{DB_POOL_SIZE:10}
      minimum-idle: ${dollar}{DB_POOL_MIN:5}
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000

  # JPA Configuration
  jpa:
    hibernate:
      ddl-auto: validate
    open-in-view: false
    show-sql: false
    properties:
      hibernate:
        format_sql: true
        type:
          preferred_uuid_jdbc_type: VARCHAR

  # Flyway Configuration
  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true
    baseline-version: '0'

server:
  port: ${dollar}{SERVER_PORT:8080}

# JWT Configuration
jwt:
  secret: ${dollar}{JWT_SECRET:default-dev-secret-change-in-production-min-256-bits-key}
  access-token-expiration: ${dollar}{JWT_ACCESS_EXPIRATION:900000}
  refresh-token-expiration: ${dollar}{JWT_REFRESH_EXPIRATION:604800000}
  issuer: ${dollar}{spring.application.name}

management:
  endpoints:
    web:
      exposure:
        include: health,info,flyway
  endpoint:
    health:
      show-details: always

# Logging Configuration
logging:
  level:
    root: ${dollar}{LOG_LEVEL:INFO}
    ${package}: ${dollar}{APP_LOG_LEVEL:DEBUG}
    org.springframework.security: ${dollar}{SECURITY_LOG_LEVEL:INFO}
    org.hibernate.SQL: ${dollar}{SQL_LOG_LEVEL:DEBUG}
    org.flywaydb: ${dollar}{FLYWAY_LOG_LEVEL:INFO}
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%X{traceId:-}] %-5level [%thread] %logger{36} - %msg%n"
  file:
    path: ${dollar}{LOG_PATH:./logs}
    name: ${dollar}{LOG_PATH:./logs}/${artifactId}.log
